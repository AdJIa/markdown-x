# Proposal: 搜索功能实现

创建时间: 2026-01-31
状态: 📝 草稿

## 问题陈述
当前 Markdown-X 缺少全局搜索功能，用户无法在多个 Markdown 文件之间快速查找内容。当站点包含大量文件时，定位特定内容变得困难。

## 解决方案概述
实现一个全局搜索功能，支持：
1. 基于文件内容的全文搜索
2. 实时搜索结果展示
3. 搜索结果预览和高亮
4. 快捷键触发 (Cmd/Ctrl + Shift + F)

## 详细设计

### 功能清单
- [ ] 搜索 UI 组件（弹窗/侧边栏）
- [ ] 主进程文件索引服务
- [ ] 搜索算法实现（支持正则和模糊匹配）
- [ ] 搜索结果渲染和高亮
- [ ] 键盘快捷键绑定
- [ ] 搜索历史记录

### 技术实现
1. **主进程**: 使用 Node.js fs 模块遍历文件，建立内容索引
2. **搜索算法**: 使用简单的字符串匹配 + 可选的正则支持
3. **渲染进程**: React 组件展示搜索 UI 和结果列表
4. **通信**: IPC 通道 `search:query` 和 `search:results`

### 文件变更
- `src/components/SearchPanel.tsx` - 搜索面板组件
- `src/components/SearchResults.tsx` - 搜索结果列表
- `electron/main.ts` - 添加搜索 IPC 处理
- `electron/preload.ts` - 暴露搜索 API
- `src/App.tsx` - 集成搜索快捷键
- `src/styles/search.css` - 搜索相关样式

## 验收标准
- [ ] 用户可以按 Cmd/Ctrl + Shift + F 打开搜索
- [ ] 输入关键词后显示匹配的文件的列表
- [ ] 点击结果跳转到对应文件并高亮匹配内容
- [ ] 支持大小写敏感/不敏感选项
- [ ] 搜索性能：1000 个文件在 1 秒内返回结果

## 风险与回滚
- **风险**: 大文件搜索可能阻塞主进程
  - **应对**: 使用 worker 线程或分块搜索
- **风险**: 索引占用过多内存
  - **应对**: 限制索引大小，使用 LRU 缓存

---
下一步: 运行 `./openspec-dev.sh plan .openspec/proposals/20260131-搜索功能实现.md` 生成任务
